{% extends "base.html" %}

{% block content %}

<div class="post-entry">
  <h2>{{ post.nazwa }}</h2>
  <p>{{ post.smiles }}</p>
  {% if not post.smiles1 != "" %}
  <p><span>Heat of Formation:</span> {{ post.cieplo }} KJ/MOL </p>  
  <p><span>Total Energy:</span> {{ post.energia }} EV </p>  
  <p><span>Method Used:</span> {{ post.metoda }} </p>  
  {% else %}
  <p><span>Heat of Formation1:</span> {{ post.cieplo1 }} KJ/MOL </p>  
  <p><span>Total Energy1:</span> {{ post.energia1 }} EV </p>  
  <p><span>Heat of Formation2:</span> {{ post.cieplo2 }} KJ/MOL </p>  
  <p><span>Total Energy2:</span> {{ post.energia2 }} EV </p>  
  <p><span>Method Used:</span> {{ post.metoda }} </p>  
  <p><a href="/media/{{post.id}}/ts.html"> REACTION </a></p>
  {% endif %}
</div>


{% if post.calculated %}
<pre>{{ post.calculations |safe }}</pre>       
{% endif %}

<img src="/media/{{post.id}}/molecule.png">
<p>
  <script src="https://unpkg.com/ngl@2.1.0-0/dist/ngl.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function (o) {
      var stage = new NGL.Stage("viewport_start") ;
      stage.loadFile("/media/{{post.id}}/start.mol2").then(function (o) {
        o.addRepresentation("ball+stick");
        // o.addRepresentation("label", {labelType: "atomname"});
        o.autoView();
      });
      stage.setSpin(true);
    });
    
    
  </script> 

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var stage = new NGL.Stage("viewport");
      stage.loadFile("/media/{{post.id}}/molecule.mol2", {defaultRepresentation: true});
    });
  
  </script>

<!-- <script>
  var status;
function readTextFile1(file)
{
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", file, false);
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
               status = rawFile.responseText;
               
            }
        }
    }
    rawFile.send(null);
}

readTextFile1("/media/{{post.id}}/start.mol2"); //calling the function
console.log(status);

//time for looping >:D
let splitStatus=status.split('\n')
for(let i=0;i<splitStatus.length;i++){
  let line=splitStatus[i];
  if(line == @<TRIPOS>BOND 
  console.log(line);
  //whateverYouWannaDoNext
}
</script> -->


  <p class="idk">Start.mol2</p> 
  <div class="scroll">
  <div id="viewport_start" style="width:400px; height:300px;"></div>
  </div>
  <div  id="buttons" style="width:500px;">
    <p>Turn:</p>
    <button id="toggleSpin" onclick="toggleSpin">Spin on</button>
    <button id="toggleBackground"  onclick="toggleBackground">Background on</button>
    <button id="toggleSideChains"  onclick="toggleSideChains">Side chains on</button>
    <button id="toggleLabels"  onclick="toggleLabels">Labels on</button>
  </div>

<img src="/media/{{post.id}}/nalesnik.png">
<img src="/media/{{post.id}}/placek.png">
  <p class="idk">Molecule.mol2</p>
  <div class="scroll2">
  <div id="viewport" style="width:400px; height:300px;"></div>
  </div>
  <div  id="buttons" style="width:500px;">
    <p>Turn:</p>
    <button id="toggleSpin" onclick="toggleSpin">Spin on</button>
    <button id="toggleBackground"  onclick="toggleBackground">Background on</button>
    <button id="toggleSideChains"  onclick="toggleSideChains">Side chains on</button>
    <button id="toggleLabels"  onclick="toggleLabels">Labels on</button>
  </div>


{% if not post.calculated %}
<p class="calculate"><a href="{% url 'post_calculate' post.pk %}">+ Calculate Molecule</a></p>  
{% endif %}
<p class="delete"><a href="{% url 'post_delete' post.pk %}">+ Delete Molecule</a></p>
{% endblock content %}
